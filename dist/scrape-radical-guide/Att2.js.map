{"version":3,"file":"Att2.js","sourceRoot":"","sources":["../../src/scrape-radical-guide/Att2.ts"],"names":[],"mappings":"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","sourcesContent":["import { Browser, launch, Page } from 'puppeteer';\nimport { Character } from './Types';\n\nexport const getData = async (): Promise<void> => {\n  const browser: Browser = await launch({ headless: false });\n  const page: Page = await browser.newPage();\n  await page.goto('http://www.babelstone.co.uk/Tangut/XHZD_Index.html');\n\n  await page.evaluate(() => {\n    // console.error(document.querySelectorAll('h1, h2, h3, h4, h5, h6'));\n\n    const headers: HTMLHeadingElement[] = Array.from(document.querySelectorAll('h1, h2, h3, h4, h5, h6'));\n\n    const findNextSiblingMatching = (el: Element | null, matcher: (el: Element) => boolean): Element | null => {\n      if (el === null || matcher(el)) {\n        return el;\n      } else {\n        return findNextSiblingMatching(el.nextElementSibling, matcher);\n      }\n    };\n\n    // tslint:disable: max-line-length\n    const findAllNextSiblingMatchingButStopAt = (el: Element | null, matcher: (el: Element) => boolean, shouldStop: (el: Element) => boolean): (Element | null)[] => {\n      if (el === null || shouldStop(el)) {\n        return [null];\n      } else if (matcher(el)) {\n        return [el, ...findAllNextSiblingMatchingButStopAt(el.nextElementSibling, matcher, shouldStop)];\n      } else {\n        return findAllNextSiblingMatchingButStopAt(el.nextElementSibling, matcher, shouldStop);\n      }\n    };\n\n    const listOfRadicalSupergroupLinks = Array.from(findNextSiblingMatching(\n      headers.filter((element: HTMLHeadingElement) => {\n        return element.textContent === 'Arrangement of Radicals';\n      })[0],\n      (el) => el.tagName === 'UL')!.querySelectorAll('a'))\n      .map(a => a.href.split('#')[1])\n      .map(t => document.querySelectorAll(`a[name=\"${t}\"]`)[0].nextElementSibling!);\n\n    const listOfRadicalGroups = listOfRadicalSupergroupLinks.map(\n      x => findAllNextSiblingMatchingButStopAt(x.nextElementSibling, z => z.tagName === 'H4', z => z.tagName === 'H3'));\n\n    const listOfRadicals = listOfRadicalGroups.map(x => x\n      .filter(y => !!y)\n      .map(y => Array.from(\n        findNextSiblingMatching(y, z => z.tagName === 'TABLE')!\n          .querySelectorAll('a'))));\n\n    const listOfStrokeCountGroupingOrCharactersHeaders = listOfRadicals\n      .map(x1 => x1\n        .map(x2 => x2\n          .map(y => (y.href || '')\n            .split('#')[1])\n          .map(y => document.querySelectorAll(`a[name=\"${y}\"]`)[0].nextElementSibling!)\n        ));\n\n    const listOfStrokeCountGroupings = listOfStrokeCountGroupingOrCharactersHeaders\n      .map(x1 => x1\n        .map(x2 => x2\n          .map(y => {\n            const groupings = findAllNextSiblingMatchingButStopAt(y.nextElementSibling, (z) => z.tagName === 'H4', z => z.tagName === 'H3')\n              .filter(z => !!z);\n            if (groupings.length === 0) { return [y]; }\n            return groupings;\n          })));\n\n    const listOfRadicalDatas = listOfStrokeCountGroupings\n      .map(x1 => x1\n        .map(x2 => x2\n          .map(x3 => x3\n            .map(y => Array.from(findNextSiblingMatching(y, z => z.tagName === 'TABLE')!\n              .querySelectorAll('tr'))\n              .map((row: HTMLTableRowElement): Character => {\n                const featurized: HTMLElement[] = Array.from(row.querySelectorAll('td, th'));\n                return {\n                  characterMojikyo: featurized[0].textContent!,\n                  characterFont: featurized[0].className!,\n                  romanization: featurized[2].textContent!,\n                  decimalIndex: featurized[3].textContent!,\n                  romanIndex: featurized[4].textContent!,\n                  characterId: featurized[5].textContent!,\n                };\n              })\n              .filter(z => z.characterMojikyo.length > 0)))\n        ));\n\n    console.error(listOfRadicalDatas);\n    // await browser.close();\n  });\n};\n"]}