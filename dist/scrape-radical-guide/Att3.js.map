{"version":3,"file":"Att3.js","sourceRoot":"","sources":["../../src/scrape-radical-guide/Att3.ts"],"names":[],"mappings":"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","sourcesContent":["import { Browser, launch, Page } from 'puppeteer';\nimport { GUID } from '../utils/UUID';\n\nexport const getData = async (): Promise<void> => {\n  const browser: Browser = await launch({ headless: false });\n  const page: Page = await browser.newPage();\n  await page.goto('http://www.babelstone.co.uk/Tangut/XHZD_Index.html');\n  await page.evaluate(async () => {\n    const headers: HTMLHeadingElement[] = Array.from(document.querySelectorAll('h1, h2, h3, h4, h5, h6'));\n\n    const findNextSiblingMatching = (el: Element | null, matcher: (el: Element) => boolean): Element | null => {\n      if (el === null || matcher(el)) {\n        return el;\n      } else {\n        return findNextSiblingMatching(el.nextElementSibling, matcher);\n      }\n    };\n\n    let counter: number = 0;\n    const getGuid = (): string => {\n      counter += 1;\n      return `${counter}`;\n    };\n\n    // tslint:disable: max-line-length\n    const findAllNextSiblingMatchingButStopAt = (el: Element | null, matcher: (el: Element) => boolean, shouldStop: (el: Element) => boolean): (Element | null)[] => {\n      if (el === null || shouldStop(el)) {\n        return [null];\n      } else if (matcher(el)) {\n        return [el, ...findAllNextSiblingMatchingButStopAt(el.nextElementSibling, matcher, shouldStop)];\n      } else {\n        return findAllNextSiblingMatchingButStopAt(el.nextElementSibling, matcher, shouldStop);\n      }\n    };\n\n    class RootPopulator {\n      public constructor(public el: Element | null) { }\n      public guid: string = getGuid();\n\n      public childSupergroups: RadicalSupergroup[] = [];\n      public populate = async () => {\n        this.childSupergroups = Array.from(findNextSiblingMatching(\n          headers.filter((element: HTMLHeadingElement) => {\n            return element.textContent === 'Arrangement of Radicals';\n          })[0],\n          (elem) => elem.tagName === 'UL')!.querySelectorAll('a'))\n          .map(a => a.href.split('#')[1])\n          .map(t => document.querySelectorAll(`a[name=\"${t}\"]`)[0].nextElementSibling!)\n          .map(e => new RadicalSupergroup(e));\n        await Promise.all(this.childSupergroups.map(supergroup => supergroup.populate));\n      }\n\n      public get data(): {} {\n        return {};\n      }\n\n      public get childSupergroupGuids(): string[] {\n        return this.childSupergroups.map(s => s.guid);\n      }\n    }\n\n    class RadicalSupergroup {\n      public constructor(public el: Element | null) {\n        console.error(el);\n      }\n      public guid: string = getGuid();\n      public get data(): {} { return {}; }\n\n      public populate = async () => {\n        return Promise.resolve();\n      }\n    }\n\n\n    const root = new RootPopulator(null);\n    await root.populate();\n    console.error(JSON.stringify(root));\n\n  });\n\n  // await browser.close();\n};\n\nexport abstract class BaseTing {\n  public constructor(public el: Element | null) {\n  }\n  public guid: string = GUID.getGuid();\n  public populate = async () => {\n    return Promise.resolve();\n  }\n\n  public get data(): {} {\n    return {};\n  }\n}\n"]}